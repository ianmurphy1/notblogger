#{extends 'main.html' /} 
#{set title:"${user.firstName}'s Blog Post: ${post.title}" /} 
#{include 'nav/open.html' /}
</ul>
#{include 'nav/close.html' /}

<div class="row-fluid">
  <div class="span6 well">
    <h4>${post.title}</h4>
    <p class="date">${post.postedAt.format('dd MMM yy')}
      ${post.postedAt.format('hh:mm')}</p>

    <p>${post.content}</p>
    <hr>
    
    <div id="createcomment">
   <form class="form" action="@{PrivateBlogPost.newVisitorComment(post.id)}" method="post">
      <div class="control-group">
        <label class="control-label">Add A Comment</label><br>
        <div class="controls">
          <textarea class="input-block-level" name="content" id="content"
            placeholder="Enter Your Comment..."></textarea>
        </div>        
      </div>
      <button id="hideCommentCreator" class="btn btn-warning" type="button">Cancel</button> 
      <button type="submit" class="btn btn-success">Add Comment</button>
    </form>
  </div>
  #{if loggedInUser}
  
    <button id="showCommentCreator" class="btn btn-primary" type="button">Add Comment</button><br>
    <a href="@{PrivateBlog.visit(blog.id)}" class="btn btn-primary"><i class="icon-backward"></i>  Back to Blog </a>
    <hr>
    
    
    <h5>Comments</h5>
    #{if post.comments.size() > 0} 
      #{list items:post.comments, as:'comment'}
        <p>${comment.content}</p>
        <p class="date">
          Left By ${comment.author}<br> ${comment.postedAt.since()}
        </p>
        #{if comment.author == loggedInUser.firstName} 
              <a href="@{PrivateBlogPost.deleteVisitorComment(comment.id)}" class="btn btn-mini">Delete</a> 
            #{/if}
        <hr>
      #{/list} 
    #{/if}    
    #{else} 
      There are no comments!! Why not be the first!
    #{/else}
    #{/if}
    
      
      <a href="@{PrivateBlog.visit(blog.id)}" class="clearbutton btn btn-primary"><i class="icon-backward"></i>  Back to Blog </a>
    
  </div>  
  </div>
  



    
</div>


    
    
    

  <script src="@{'/public/javascripts/blogger.js'}"></script>
<script>
    $("#createcomment").hide();
  </script>
<script>
  $(document).ready(function() {
    loadPostEventHandlers();
  });     
</script>